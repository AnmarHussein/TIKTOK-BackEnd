select u.username , u.imagepath , v.* from video v
INNER JOIN USER1 U ON U.ID = V.userid;

Create Table video(
 ID NUMBER GENERATED BY DEFAULT AS IDENTITY CONSTRAINT PK_video PRIMARY Key,
 title Varchar2(255),
 posterpath Varchar2(255),
 videopath VARCHAR2(255),
 createat Date,
 isblock number(1) DEFAULT 0,
 USERID number CONSTRAINT Fk_User_Video REFERENCES USER1(ID) on delete Cascade);


CREATE OR REPLACE PACKAGE  video_PACKAGE AS

    PROCEDURE video_CRUD(P_ACTION in varchar DEFAULT NULL 
    ,P_ID IN NUMBER DEFAULT NULL
    ,P_title IN VARCHAR DEFAULT NULL
    ,P_posterpath IN VARCHAR DEFAULT NULL
    ,P_videopath IN VARCHAR DEFAULT NULL
    ,P_createat IN DATE DEFAULT NULL
    ,P_isblock IN NUMBER DEFAULT 0  
    ,P_USERID IN NUMBER DEFAULT NULL    
    );
    
End video_PACKAGE;



CREATE OR REPLACE PACKAGE BODY video_PACKAGE AS
    
    PROCEDURE video_CRUD(P_ACTION in varchar DEFAULT NULL 
    ,P_ID IN NUMBER DEFAULT NULL
    ,P_title IN VARCHAR DEFAULT NULL
    ,P_posterpath IN VARCHAR DEFAULT NULL
    ,P_videopath IN VARCHAR DEFAULT NULL
    ,P_createat IN DATE DEFAULT NULL
    ,P_isblock IN NUMBER DEFAULT 0  
    ,P_USERID IN NUMBER DEFAULT NULL    
    )
    IS
        video_all SYS_REFCURSOR;
    BEGIN
        EXECUTE IMMEDIATE 'ALTER SESSION SET NLS_DATE_FORMAT=''DD-MON-YYYY HH24:MI:SS''';
        IF P_ACTION = 'INSERT' THEN
            INSERT INTO video VALUES(DEFAULT,P_title,P_posterpath,P_videopath,To_DATE(P_createat,'DD-MM-YYYY HH24:MI:SS'),P_isblock,P_USERID); 
            COMMIT;
        ELSIF P_ACTION = 'UPDATE' THEN

            UPDATE video SET
                TITLE = P_title , posterpath = P_posterpath,
                videopath = P_videopath , 
                CREATEAT = To_DATE(P_createat,'DD-MM-YYYY HH24:MI:SS') ,
                USERID = P_USERID , ISBLOCK = P_isblock
            WHERE ID = P_ID;
            COMMIT;

        ELSIF P_ACTION = 'DELETE' THEN
            DELETE video WHERE ID = P_ID;
            COMMIT;

        ELSIF P_ACTION = 'GETALL' THEN
            OPEN video_all FOR select u.username , u.imagepath , v.* from video v
                                INNER JOIN USER1 U ON U.ID = V.userid;
            dbms_sql.return_result(video_all);

        ELSIF P_ACTION = 'GETBYID' THEN
            OPEN video_all FOR SELECT u.username , u.imagepath,v.* FROM VIDEO v
            INNER JOIN USER1 U ON U.ID = v.userid
            WHERE v.ID = P_ID;
            dbms_sql.return_result(video_all);  
        END IF;
    END video_CRUD;

END video_PACKAGE;
