Create Table Promote(
 ID NUMBER GENERATED BY DEFAULT AS IDENTITY CONSTRAINT PK_Promote PRIMARY Key,
 createat date,
 amount number,
 videoid number CONSTRAINT FK_Promote_video REFERENCES video(ID) on delete cascade,
 cardid number CONSTRAINT FK_Promote_VISACARD REFERENCES VISACARD(ID) on delete cascade,
 PromoteTypeid number CONSTRAINT FK_Promote_PromoteType REFERENCES PromoteType(ID) on delete cascade
);

CREATE OR REPLACE PACKAGE  Promote_PACKAGE AS

    PROCEDURE Promote_CRUD(P_ACTION in varchar DEFAULT NULL 
    ,P_ID IN NUMBER DEFAULT NULL
    ,P_createat IN DATE DEFAULT NULL
    ,P_amount IN NUMBER DEFAULT NULL
    ,P_videoid IN number DEFAULT NULL
    ,P_cardid IN number DEFAULT NULL
    ,P_PromoteTypeid IN number DEFAULT NULL);
    
End Promote_PACKAGE;



CREATE OR REPLACE PACKAGE BODY Promote_PACKAGE AS
    
    PROCEDURE Promote_CRUD(P_ACTION in varchar DEFAULT NULL 
    ,P_ID IN NUMBER DEFAULT NULL
    ,P_createat IN DATE DEFAULT NULL
    ,P_amount IN NUMBER DEFAULT NULL
    ,P_videoid IN number DEFAULT NULL
    ,P_cardid IN number DEFAULT NULL
    ,P_PromoteTypeid IN number DEFAULT NULL)
    IS
        Promote_all SYS_REFCURSOR;
    BEGIN
         EXECUTE IMMEDIATE 'ALTER SESSION SET NLS_DATE_FORMAT=''DD-MON-YYYY HH24:MI:SS''';
        IF P_ACTION = 'INSERT' THEN
            INSERT INTO Promote VALUES(DEFAULT,To_DATE(P_createat,'DD-MM-YYYY HH24:MI:SS'),P_amount,P_videoid,P_cardid,P_PromoteTypeid); 
            COMMIT;
        ELSIF P_ACTION = 'UPDATE' THEN

            UPDATE Promote SET
                createat = To_DATE(P_createat,'DD-MM-YYYY HH24:MI:SS') ,
                amount = P_amount , videoid = P_videoid,
                cardid = P_cardid , PromoteTypeid =P_PromoteTypeid
            WHERE ID = P_ID;
            COMMIT;

        ELSIF P_ACTION = 'DELETE' THEN
            DELETE Promote WHERE ID = P_ID;
            COMMIT;

        ELSIF P_ACTION = 'GETALL' THEN
            OPEN Promote_all FOR SELECT * FROM Promote;
            dbms_sql.return_result(Promote_all);

        ELSIF P_ACTION = 'GETBYID' THEN
            OPEN Promote_all FOR SELECT * FROM Promote WHERE ID = P_ID;
            dbms_sql.return_result(Promote_all);  
        END IF;
    END Promote_CRUD;

END Promote_PACKAGE;